<!-- ========================================
=         Product Detail Template          =
========================================= -->
<!-- зміна: створено універсальний шаблон для сторінок товарів -->

<main>
  <!-- Product Hero Section -->
  <section class="product-hero py-5 bg-light">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-lg-6 mb-4 mb-lg-0">
          <!-- Product Image -->
          <div class="product-image-container text-center">
            <img 
              src="@@mainImage" 
              alt="@@productName" 
              class="img-fluid product-main-image"
              style="max-height: 500px; object-fit: contain;"
            />
          </div>
        </div>
        
        <div class="col-lg-6">
          <!-- Product Info -->
          <div class="product-info">
            <!-- Breadcrumb -->
            <nav aria-label="breadcrumb" class="mb-3">
              <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="../../index.html">Головна</a></li>
                <li class="breadcrumb-item"><a href="@@categoryLink">@@categoryName</a></li>
                <li class="breadcrumb-item active" aria-current="page">@@productName</li>
              </ol>
            </nav>
            
            <!-- Product Badge -->
            <div class="product-badges mb-3">
              <span class="badge bg-primary me-2">З США</span>
              <span class="badge bg-success">В наявності</span>
            </div>
            
            <!-- Product Title -->
            <h1 class="product-title h2 fw-bold mb-3">@@productName</h1>
            
            <!-- Product Description -->
            <p class="product-description lead text-muted mb-4">@@productDescription</p>
            
            <!-- Price -->
            <div class="product-price mb-4">
              <div class="current-price h3 fw-bold text-primary mb-1">@@currentPrice ₴</div>
              <div class="old-price text-muted text-decoration-line-through">@@oldPrice ₴</div>
              <div class="savings text-success small">
                <i class="fas fa-arrow-down me-1"></i>
                Економія: @@savings ₴
              </div>
            </div>
            
            <!-- Key Features -->
            <div class="key-features mb-4">
              <h6 class="fw-semibold mb-2">Основні характеристики:</h6>
              <ul class="list-unstyled">
                @@keyFeatures
              </ul>
            </div>
            
            <!-- Action Buttons -->
            <div class="product-actions">
              <button 
                class="btn btn-primary btn-lg me-3 mb-2"
                data-bs-toggle="modal" 
                data-bs-target="#productOrderModal"
                data-product-title="@@productName"
                data-product-price="@@currentPrice"
                data-product-image="@@mainImage"
              >
                <i class="fas fa-shopping-cart me-2"></i>
                Оформити заявку
              </button>
              
              <button class="btn btn-outline-secondary btn-lg mb-2" onclick="history.back()">
                <i class="fas fa-arrow-left me-2"></i>
                Назад до каталогу
              </button>
            </div>
            
            <!-- Additional Info -->
            <div class="additional-info mt-4 p-3 bg-white rounded border">
              <div class="row text-center">
                <div class="col-4">
                  <i class="fas fa-shipping-fast text-primary mb-2 d-block" style="font-size: 1.5rem;"></i>
                  <small>Швидка доставка</small>
                </div>
                <div class="col-4">
                  <i class="fas fa-shield-alt text-success mb-2 d-block" style="font-size: 1.5rem;"></i>
                  <small>Гарантія якості</small>
                </div>
                <div class="col-4">
                  <i class="fas fa-headset text-info mb-2 d-block" style="font-size: 1.5rem;"></i>
                  <small>24/7 підтримка</small>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  
  <!-- Product Details Tabs -->
  <section class="product-details py-5">
    <div class="container">
      <ul class="nav nav-tabs mb-4" id="productTabs" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active" id="specs-tab" data-bs-toggle="tab" data-bs-target="#specs" type="button" role="tab">
            Характеристики
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="delivery-tab" data-bs-toggle="tab" data-bs-target="#delivery" type="button" role="tab">
            Доставка
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="warranty-tab" data-bs-toggle="tab" data-bs-target="#warranty" type="button" role="tab">
            Гарантія
          </button>
        </li>
      </ul>
      
      <div class="tab-content" id="productTabsContent">
        <!-- Specifications Tab -->
        <div class="tab-pane fade show active" id="specs" role="tabpanel">
          <div class="row">
            <div class="col-lg-8">
              <div class="specifications-table">
                <h5 class="mb-3">Технічні характеристики</h5>
                <table class="table table-striped">
                  <tbody>
                    @@specifications
                  </tbody>
                </table>
              </div>
            </div>
            <div class="col-lg-4">
              <div class="card border-0 bg-light">
                <div class="card-body">
                  <h6 class="card-title">Що входить у комплект:</h6>
                  <ul class="list-unstyled mb-0">
                    @@packageContents
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Delivery Tab -->
        <div class="tab-pane fade" id="delivery" role="tabpanel">
          <div class="row">
            <div class="col-lg-6">
              <h5>Варіанти доставки</h5>
              <div class="delivery-options">
                <div class="delivery-option mb-3 p-3 border rounded">
                  <div class="d-flex justify-content-between align-items-center">
                    <div>
                      <h6 class="mb-1">Нова Пошта</h6>
                      <small class="text-muted">1-2 робочі дні</small>
                    </div>
                    <span class="fw-bold">від 80 ₴</span>
                  </div>
                </div>
                <div class="delivery-option mb-3 p-3 border rounded">
                  <div class="d-flex justify-content-between align-items-center">
                    <div>
                      <h6 class="mb-1">Укрпошта</h6>
                      <small class="text-muted">3-5 робочих днів</small>
                    </div>
                    <span class="fw-bold">від 50 ₴</span>
                  </div>
                </div>
                <div class="delivery-option p-3 border rounded border-success">
                  <div class="d-flex justify-content-between align-items-center">
                    <div>
                      <h6 class="mb-1 text-success">Безкоштовна доставка</h6>
                      <small class="text-muted">При замовленні від 15 000 ₴</small>
                    </div>
                    <span class="fw-bold text-success">0 ₴</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-lg-6">
              <h5>Оплата</h5>
              <ul class="list-unstyled">
                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Готівкою при отриманні</li>
                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Карткою онлайн</li>
                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Банківський переказ</li>
                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Оплата частинами</li>
              </ul>
            </div>
          </div>
        </div>
        
        <!-- Warranty Tab -->
        <div class="tab-pane fade" id="warranty" role="tabpanel">
          <div class="row">
            <div class="col-lg-8">
              <h5>Гарантійні умови</h5>
              <div class="warranty-info">
                <div class="mb-4">
                  <h6>Офіційна гарантія Apple</h6>
                  <p>Всі наші пристрої поставляються з офіційною гарантією Apple строком на 12 місяців. Гарантія покриває виробничі дефекти та несправності.</p>
                </div>
                
                <div class="mb-4">
                  <h6>Умови гарантії</h6>
                  <ul>
                    <li>Безкоштовний ремонт або заміна при виробничих дефектах</li>
                    <li>Сервісне обслуговування в офіційних сервісних центрах Apple</li>
                    <li>Підтримка AppleCare при необхідності</li>
                  </ul>
                </div>
                
                <div class="alert alert-info">
                  <i class="fas fa-info-circle me-2"></i>
                  <strong>Важливо:</strong> Гарантія не покриває механічні пошкодження, попадання вологи та наслідки неправильної експлуатації.
                </div>
              </div>
            </div>
            <div class="col-lg-4">
              <div class="card border-0 bg-primary text-white">
                <div class="card-body text-center">
                  <i class="fas fa-shield-alt mb-3" style="font-size: 3rem;"></i>
                  <h6>Розширена гарантія</h6>
                  <p class="mb-3">Подовжте гарантію до 24 місяців</p>
                  <button class="btn btn-light btn-sm">Дізнатися більше</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  
  <!-- Related Products -->
  <section class="related-products py-5 bg-light">
    <div class="container">
      <h3 class="text-center mb-5">Схожі товари</h3>
      <div class="row">
        @@relatedProducts
      </div>
    </div>
  </section>
</main>

<!-- Product Order Modal (Universal) -->
<div class="modal fade" id="productOrderModal" tabindex="-1" aria-labelledby="productOrderModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content border-0 shadow-lg">
      <div class="modal-header bg-light border-0">
        <h5 class="modal-title fw-bold" id="productOrderModalLabel">
          <i class="fas fa-mobile-alt text-primary me-2"></i>
          Оформити заявку
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Закрити"></button>
      </div>
      
      <div class="modal-body p-4">
        <div class="row">
          <div class="col-md-5 mb-4">
            <div class="selected-product-info">
              <div class="product-preview text-center mb-3">
                <img id="modalProductImage" src="" alt="" class="img-fluid rounded" style="max-height: 200px;">
              </div>
              <h6 class="fw-bold" id="modalProductTitle"></h6>
              <p class="text-muted small mb-2">Оригінальний товар з США</p>
              <p class="h5 text-primary fw-bold mb-0">
                <span id="modalProductPrice"></span> ₴
              </p>
            </div>
          </div>
          
          <div class="col-md-7">
            <form id="productOrderForm" class="needs-validation" novalidate>
              <div class="mb-3">
                <label for="customerName" class="form-label fw-semibold">
                  <i class="fas fa-user text-muted me-1"></i>Ваше ім'я *
                </label>
                <input 
                  type="text" 
                  class="form-control form-control-lg" 
                  id="customerName" 
                  placeholder="Введіть ваше ім'я"
                  required
                  minlength="2"
                >
                <div class="invalid-feedback">
                  Будь ласка, введіть ваше ім'я (мінімум 2 символи)
                </div>
              </div>
              
              <div class="mb-3">
                <label for="customerPhone" class="form-label fw-semibold">
                  <i class="fas fa-phone text-muted me-1"></i>Телефон *
                </label>
                <input 
                  type="tel" 
                  class="form-control form-control-lg" 
                  id="customerPhone" 
                  placeholder="+380 XX XXX XX XX"
                  required
                  pattern="^\+380\d{9}$"
                >
                <div class="invalid-feedback">
                  Введіть правильний номер телефону (+380XXXXXXXXX)
                </div>
              </div>
              
              <div class="mb-3">
                <label for="customerEmail" class="form-label fw-semibold">
                  <i class="fas fa-envelope text-muted me-1"></i>Email (опціонально)
                </label>
                <input 
                  type="email" 
                  class="form-control form-control-lg" 
                  id="customerEmail" 
                  placeholder="your@email.com"
                >
              </div>
              
              <div class="mb-4">
                <label for="customerMessage" class="form-label fw-semibold">
                  <i class="fas fa-comment text-muted me-1"></i>Коментар (опціонально)
                </label>
                <textarea 
                  class="form-control" 
                  id="customerMessage" 
                  rows="3" 
                  placeholder="Додаткові побажання щодо замовлення..."
                ></textarea>
              </div>
              
              <input type="hidden" id="selectedProduct" name="product">
              <input type="hidden" id="selectedPrice" name="price">
              
              <div class="d-grid gap-2">
                <button type="submit" class="btn btn-primary btn-lg">
                  <i class="fas fa-paper-plane me-2"></i>
                  Надіслати заявку
                </button>
                <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
                  Скасувати
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Success Modal -->
<div class="modal fade" id="successModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content border-0 shadow">
      <div class="modal-body text-center p-5">
        <div class="success-icon mb-4">
          <i class="fas fa-check-circle text-success" style="font-size: 4rem;"></i>
        </div>
        <h4 class="fw-bold mb-3">Заявка надіслана!</h4>
        <p class="text-muted mb-4">
          Дякуємо за ваш інтерес до нашої продукції. 
          Наш менеджер зв'яжеться з вами протягом 15 хвилин.
        </p>
        <button type="button" class="btn btn-primary" data-bs-dismiss="modal">
          Зрозуміло
        </button>
      </div>
    </div>
  </div>
</div>

<style>
/* Product Detail Page Styles */
.product-main-image {
  transition: transform 0.3s ease;
}

.product-main-image:hover {
  transform: scale(1.05);
}

.product-badges .badge {
  font-size: 0.8rem;
  padding: 8px 12px;
}

.key-features li {
  padding: 0.25rem 0;
}

.key-features li::before {
  content: "✓";
  color: #28a745;
  font-weight: bold;
  margin-right: 0.5rem;
}

.specifications-table table {
  background: white;
  border-radius: 8px;
  overflow: hidden;
}

.delivery-option {
  transition: all 0.3s ease;
}

.delivery-option:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.nav-tabs .nav-link {
  border: none;
  border-bottom: 3px solid transparent;
  color: #6c757d;
  font-weight: 600;
}

.nav-tabs .nav-link.active {
  background: none;
  border-bottom-color: #007bff;
  color: #007bff;
}

.selected-product-info {
  background: linear-gradient(135deg, #f8f9fa 0%, #f1f3f4 100%);
  padding: 20px;
  border-radius: 16px;
  border: 1px solid #e9ecef;
}

@media (max-width: 768px) {
  .product-actions .btn {
    width: 100%;
    margin-bottom: 10px;
  }
  
  .current-price {
    font-size: 1.5rem !important;
  }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Product Order Modal Logic
  const orderModal = document.getElementById('productOrderModal');
  const successModal = document.getElementById('successModal');
  const orderForm = document.getElementById('productOrderForm');
  
  if (orderModal) {
    orderModal.addEventListener('show.bs.modal', function(event) {
      const button = event.relatedTarget;
      const productTitle = button.getAttribute('data-product-title');
      const productPrice = button.getAttribute('data-product-price');
      const productImage = button.getAttribute('data-product-image');
      
      const modalTitle = orderModal.querySelector('#modalProductTitle');
      const modalPrice = orderModal.querySelector('#modalProductPrice');
      const modalImage = orderModal.querySelector('#modalProductImage');
      const hiddenProduct = orderModal.querySelector('#selectedProduct');
      const hiddenPrice = orderModal.querySelector('#selectedPrice');
      
      if (modalTitle) modalTitle.textContent = productTitle;
      if (modalPrice) modalPrice.textContent = productPrice;
      if (modalImage) {
        modalImage.src = productImage;
        modalImage.alt = productTitle;
      }
      if (hiddenProduct) hiddenProduct.value = productTitle;
      if (hiddenPrice) hiddenPrice.value = productPrice;
    });
  }
  
  // Phone Mask
  const phoneInput = document.getElementById('customerPhone');
  if (phoneInput) {
    phoneInput.addEventListener('input', function(e) {
      let value = e.target.value.replace(/\D/g, '');
      
      if (value.length > 0 && !value.startsWith('380')) {
        if (value.startsWith('0')) {
          value = '380' + value.substring(1);
        } else if (!value.startsWith('380')) {
          value = '380' + value;
        }
      }
      
      if (value.length > 12) {
        value = value.substring(0, 12);
      }
      
      let formatted = '+';
      if (value.length > 0) formatted += value.substring(0, 3);
      if (value.length > 3) formatted += ' ' + value.substring(3, 5);
      if (value.length > 5) formatted += ' ' + value.substring(5, 8);
      if (value.length > 8) formatted += ' ' + value.substring(8, 10);
      if (value.length > 10) formatted += ' ' + value.substring(10, 12);
      
      e.target.value = formatted;
    });
    
    if (phoneInput.value === '') {
      phoneInput.value = '+380 ';
    }
  }
  
  // Form Submission
  if (orderForm) {
    orderForm.addEventListener('submit', function(e) {
      e.preventDefault();
      
      if (!orderForm.checkValidity()) {
        e.stopPropagation();
        orderForm.classList.add('was-validated');
        return;
      }
      
      const formData = {
        product: document.getElementById('selectedProduct').value,
        price: document.getElementById('selectedPrice').value,
        name: document.getElementById('customerName').value,
        phone: document.getElementById('customerPhone').value,
        email: document.getElementById('customerEmail').value,
        message: document.getElementById('customerMessage').value,
        timestamp: new Date().toISOString()
      };
      
      const submitBtn = orderForm.querySelector('button[type="submit"]');
      const originalText = submitBtn.innerHTML;
      submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Відправляємо...';
      submitBtn.disabled = true;
      
      setTimeout(() => {
        console.log('Order submitted:', formData);
        
        const orderModalInstance = bootstrap.Modal.getInstance(orderModal);
        orderModalInstance.hide();
        
        const successModalInstance = new bootstrap.Modal(successModal);
        successModalInstance.show();
        
        orderForm.reset();
        orderForm.classList.remove('was-validated');
        
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
        
        if (phoneInput) {
          phoneInput.value = '+380 ';
        }
      }, 1500);
    });
  }
  
  // Form Validation
  const formInputs = orderForm?.querySelectorAll('input, textarea');
  formInputs?.forEach(input => {
    input.addEventListener('input', function() {
      if (input.checkValidity()) {
        input.classList.remove('is-invalid');
        input.classList.add('is-valid');
      } else {
        input.classList.remove('is-valid');
        input.classList.add('is-invalid');
      }
    });
  });
});
</script> 